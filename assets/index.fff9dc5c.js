import{r as _,c as b,o as J,a as v,b as m,d as s,t as D,e as B,w as W,n as C,u as E,F as q,f as z,g as K,v as X,h as Y,i as H,j as Q}from"./js/@vue-1bb6992b.js";import{E as L,_ as S}from"./js/jsPDF-b882dd9c.js";import"./js/@babel-62c7c66b.js";import"./js/fflate-2f5a53d7.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function u(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerpolicy&&(l.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?l.credentials="include":e.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(e){if(e.ep)return;e.ep=!0;const l=u(e);fetch(e.href,l)}})();const Z={class:"pdf-wrapper"},ee={class:"btns-box"},te={key:0},ne=["onClick"],ae={class:"scroll"},oe=["id"],se={__name:"Pdf",props:{url:{type:String,default:null}},emits:["getImg"],setup(h,{emit:i}){const u=h;_(null);const r=_(null),e=_({tempPage:1,page:1,numPages:0,scale:1,height:0,width:0});let l=null,d={};const I=n=>{switch(n){case"minus":{e.value.scale=(e.value.scale*10-1)/10;break}case"plus":{e.value.scale=(e.value.scale*10+1)/10;break}}};function A(n){const t=n.target||n.srcElement,o=t.getContext("2d");o.beginPath(),t.onmousemove=function(a){if(a.which===0){t.onmousemove=null,t.onmouseup=null;return}o.strokeStyle="blue",o.lineWidth=2,o.lineTo(a.offsetX,a.offsetY),o.stroke()},t.onmouseup=function(){t.onmousemove=null,t.onmouseup=null},t.focus()}const O=()=>{try{const n=document.getElementById(`the-canvas-${e.value.page}`);r.value=n.toDataURL("image/png",1),i("getImg",r.value)}catch(n){console.warn(n)}},R=n=>{Y(()=>{const t=document.getElementById(`the-canvas-${e.value.page}`);t.getContext("2d").clearRect(0,0,t.width,t.height),d[e.value.page]=!1,$()})},M=()=>{e.value.page=e.value.page-1,y(e.value.page)},N=()=>{e.value.page=e.value.page+1,y(e.value.page)},w=_(!1),U=async()=>{const n=document.getElementById(`the-canvas-${e.value.page}`),t=n.width>n.height?"l":"",o=new L(t,"px",[n.width,n.height]),a=n.toDataURL("image/png",1);o.addImage(a,"JPEG",0,0,n.width,n.height),o.save(`${e.value.page}.pdf`)},V=async()=>{w.value=!0;let n=0,t=0,o,a=[];for(let g=1;g<=e.value.numPages;g++)if(d[g]){const c=document.getElementById(`the-canvas-${g}`);o=c.width>c.height?"l":"",n=c.width,t=c.height;const k=c.toDataURL("image/png",1);a.push(k),console.log(g)}else{let c=await l.getPage(g);var P=1,f=c.getViewport({scale:P}),p=document.createElement("canvas"),j=p.getContext("2d");p.height=f.height,p.width=f.width,await c.render({canvasContext:j,viewport:f}).promise;const k=p.toDataURL("image/png",1);n=p.width,t=p.height,a.push(k),console.log(g)}console.log("save",a);const x=new L(o,"px",[n,t]);a.forEach((g,c)=>{x.addImage(g,"JPEG",0,0,n,t),c+1!==a.length&&x.addPage()}),x.save("all.pdf"),w.value=!1},y=n=>{console.log("isLoaded",d),d[""+n]?e.value.tempPage=e.value.page:l.getPage(n).then(function(t){var o=t.getViewport({scale:1}),a=document.getElementById(`the-canvas-${e.value.page}`),P=a.getContext("2d");a.height=o.height,a.width=o.width,e.value.width=a.width,e.value.height=a.height;var f={canvasContext:P,viewport:o},p=t.render(f);p.promise.then(function(){d[""+e.value.page]=!0,e.value.tempPage=e.value.page})},t=>{throw e.value.page=e.value.tempPage,Error("the page is not exist")})},$=async()=>{if(!u.url)return!1;const n=await S(()=>import("./js/pdfjs-dist-95ebc730.js").then(a=>a.p),["assets/js/pdfjs-dist-95ebc730.js","assets/js/core-js-b4b67889.js"]),t=await S(()=>import("./js/pdfjs-dist-95ebc730.js").then(a=>a.a),["assets/js/pdfjs-dist-95ebc730.js","assets/js/core-js-b4b67889.js"]);n.GlobalWorkerOptions.workerSrc=t;var o=n.getDocument(u.url);o.promise.then(function(a){l=a,e.value.numPages=a.numPages,y(e.value.page)},a=>{console.log(a)})},T=b(()=>{let n=Math.ceil(e.value.width/20),t=Math.ceil(e.value.height/20),o=e.value.scale>1?e.value.scale*10-10:0;return{padding:`${o*t}px ${o*n}px`}}),F=b(()=>{let n=e.value.width,t=e.value.height;return{width:`${n}px`,height:`${t}px`}}),G=b(()=>({transform:`scale(${e.value.scale})`}));return J(()=>{$()}),(n,t)=>(v(),m("div",Z,[s("div",ee,[s("p",null,"\u9801\u78BC:"+D(`${e.value.page} /${e.value.numPages}`),1),s("p",null,"scale: "+D(e.value.scale),1),w.value?(v(),m("p",te,"saving...")):B("",!0),s("div",null,[s("button",{type:"danger",onClick:W(R,["prevent"])},"\u6E05\u7A7A\u7B46\u8DE1",8,ne),s("button",{type:"primary",onClick:O},"\u751F\u6210\u5716\u7247"),s("button",{onClick:t[0]||(t[0]=()=>{I("minus")})}," scale -- "),s("button",{onClick:t[1]||(t[1]=()=>{I("plus")})}," scale ++ "),s("button",{onClick:U},"\u55AE\u9801PDF\u5132\u5B58"),s("button",{onClick:N},"\u4E0B\u4E00\u9801"),s("button",{onClick:M},"\u4E0A\u4E00\u9801"),s("button",{onClick:V},"\u5132\u5B58\u5168\u90E8")])]),s("div",ae,[s("div",{class:"pdfs-box",style:C(E(T))},[s("div",{class:"pdf-Item",style:C(E(F))},[(v(!0),m(q,null,z(e.value.numPages,o=>(v(),m("div",{key:o,style:C(E(G))},[K(s("canvas",{id:`the-canvas-${o}`,onMousedown:A},null,40,oe),[[X,o===e.value.page]])],4))),128))],4)],4)])]))}};const le=(h,i)=>{const u=h.__vccOpts||h;for(const[r,e]of i)u[r]=e;return u},ie={class:"box"},re=["src"],ce={__name:"App",setup(h){const i=_(null),u=r=>{const e=document.createElement("a");e.download="test.png",e.href=r,e.target="_blank",document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)};return(r,e)=>(v(),m("div",ie,[H(se,{url:"./test.pdf",onGetImg:u}),i.value?(v(),m("img",{key:0,src:i.value,alt:"\u751F\u6210"},null,8,re)):B("",!0)]))}},ue=le(ce,[["__scopeId","data-v-929a7919"]]);Q(ue).mount("#app");

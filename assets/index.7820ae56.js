import{r as _,c as b,o as Y,a as v,b as m,d as s,t as D,e as B,w as j,n as C,u as E,F as J,f as q,g as z,v as K,h as W,i as H,j as Q}from"./js/@vue-1bb6992b.js";import{E as L,_ as S}from"./js/jsPDF-b882dd9c.js";import"./js/@babel-62c7c66b.js";import"./js/fflate-2f5a53d7.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const l of e)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function u(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerpolicy&&(l.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?l.credentials="include":e.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(e){if(e.ep)return;e.ep=!0;const l=u(e);fetch(e.href,l)}})();const Z={class:"pdf-wrapper"},ee={class:"btns-box"},te={key:0},ne=["onClick"],ae={class:"scroll"},oe=["id"],se={__name:"Pdf",props:{url:{type:String,default:null}},emits:["getImg"],setup(h,{emit:r}){const u=h;_(null);const i=_(null),e=_({tempPage:1,page:1,numPages:0,scale:1,height:0,width:0});let l=null,d={};const I=t=>{switch(t){case"minus":{e.value.scale=(e.value.scale*10-1)/10;break}case"plus":{e.value.scale=(e.value.scale*10+1)/10;break}}},A=t=>{const n=t.target||t.srcElement,a=n.getContext("2d");a.beginPath(),a.moveTo(t.offsetX,t.offsetY),a.lineTo(t.offsetX,t.offsetY),a.stroke(),n.onmousemove=function(o){if(o.which===0){n.onmousemove=null,n.onmouseup=null;return}a.lineTo(o.offsetX,o.offsetY),a.stroke()},n.onmouseup=function(){n.onmousemove=null,n.onmouseup=null},n.focus()},O=()=>{try{const t=document.getElementById(`the-canvas-${e.value.page}`);i.value=t.toDataURL("image/png",1),r("getImg",i.value)}catch(t){console.warn(t)}},R=t=>{W(()=>{const n=document.getElementById(`the-canvas-${e.value.page}`);n.getContext("2d").clearRect(0,0,n.width,n.height),d[e.value.page]=!1,$()})},T=()=>{e.value.page=e.value.page-1,y(e.value.page)},M=()=>{e.value.page=e.value.page+1,y(e.value.page)},w=_(!1),N=async()=>{const t=document.getElementById(`the-canvas-${e.value.page}`),n=t.width>t.height?"l":"",a=new L(n,"px",[t.width,t.height]),o=t.toDataURL("image/png",1);a.addImage(o,"JPEG",0,0,t.width,t.height),a.save(`${e.value.page}.pdf`)},U=async()=>{w.value=!0;let t=0,n=0,a,o=[];for(let g=1;g<=e.value.numPages;g++)if(d[g]){const c=document.getElementById(`the-canvas-${g}`);a=c.width>c.height?"l":"",t=c.width,n=c.height;const k=c.toDataURL("image/png",1);o.push(k),console.log(g)}else{let c=await l.getPage(g);var P=1,f=c.getViewport({scale:P}),p=document.createElement("canvas"),X=p.getContext("2d");p.height=f.height,p.width=f.width,await c.render({canvasContext:X,viewport:f}).promise;const k=p.toDataURL("image/png",1);t=p.width,n=p.height,o.push(k),console.log(g)}console.log("save",o);const x=new L(a,"px",[t,n]);o.forEach((g,c)=>{x.addImage(g,"JPEG",0,0,t,n),c+1!==o.length&&x.addPage()}),x.save("all.pdf"),w.value=!1},y=t=>{console.log("isLoaded",d),d[""+t]?e.value.tempPage=e.value.page:l.getPage(t).then(function(n){var a=n.getViewport({scale:1}),o=document.getElementById(`the-canvas-${e.value.page}`),P=o.getContext("2d");o.height=a.height,o.width=a.width,e.value.width=o.width,e.value.height=o.height;var f={canvasContext:P,viewport:a},p=n.render(f);p.promise.then(function(){d[""+e.value.page]=!0,e.value.tempPage=e.value.page})},n=>{throw e.value.page=e.value.tempPage,Error("the page is not exist")})},$=async()=>{if(!u.url)return!1;const t=await S(()=>import("./js/pdfjs-dist-95ebc730.js").then(o=>o.p),["assets/js/pdfjs-dist-95ebc730.js","assets/js/core-js-b4b67889.js"]),n=await S(()=>import("./js/pdfjs-dist-95ebc730.js").then(o=>o.a),["assets/js/pdfjs-dist-95ebc730.js","assets/js/core-js-b4b67889.js"]);t.GlobalWorkerOptions.workerSrc=n;var a=t.getDocument(u.url);a.promise.then(function(o){l=o,e.value.numPages=o.numPages,y(e.value.page)},o=>{console.log(o)})},V=b(()=>{let t=Math.ceil(e.value.width/20),n=Math.ceil(e.value.height/20),a=e.value.scale>1?e.value.scale*10-10:0;return{padding:`${a*n}px ${a*t}px`}}),F=b(()=>{let t=e.value.width,n=e.value.height;return{width:`${t}px`,height:`${n}px`}}),G=b(()=>({transform:`scale(${e.value.scale})`}));return Y(()=>{$()}),(t,n)=>(v(),m("div",Z,[s("div",ee,[s("p",null,"\u9801\u78BC:"+D(`${e.value.page} /${e.value.numPages}`),1),s("p",null,"scale: "+D(e.value.scale),1),w.value?(v(),m("p",te,"saving...")):B("",!0),s("div",null,[s("button",{type:"danger",onClick:j(R,["prevent"])},"\u6E05\u7A7A\u7B46\u8DE1",8,ne),s("button",{type:"primary",onClick:O},"\u751F\u6210\u5716\u7247"),s("button",{onClick:n[0]||(n[0]=()=>{I("minus")})}," scale -- "),s("button",{onClick:n[1]||(n[1]=()=>{I("plus")})}," scale ++ "),s("button",{onClick:N},"\u55AE\u9801PDF\u5132\u5B58"),s("button",{onClick:M},"\u4E0B\u4E00\u9801"),s("button",{onClick:T},"\u4E0A\u4E00\u9801"),s("button",{onClick:U},"\u5132\u5B58\u5168\u90E8")])]),s("div",ae,[s("div",{class:"pdfs-box",style:C(E(V))},[s("div",{class:"pdf-Item",style:C(E(F))},[(v(!0),m(J,null,q(e.value.numPages,a=>(v(),m("div",{key:a,style:C(E(G))},[z(s("canvas",{id:`the-canvas-${a}`,onMousedown:A},null,40,oe),[[K,a===e.value.page]])],4))),128))],4)],4)])]))}};const le=(h,r)=>{const u=h.__vccOpts||h;for(const[i,e]of r)u[i]=e;return u},re={class:"box"},ie=["src"],ce={__name:"App",setup(h){const r=_(null),u=i=>{const e=document.createElement("a");e.download="test.png",e.href=i,e.target="_blank",document.body.appendChild(e),e.click(),e.parentNode.removeChild(e)};return(i,e)=>(v(),m("div",re,[H(se,{url:"./test.pdf",onGetImg:u}),r.value?(v(),m("img",{key:0,src:r.value,alt:"\u751F\u6210"},null,8,ie)):B("",!0)]))}},ue=le(ce,[["__scopeId","data-v-929a7919"]]);Q(ue).mount("#app");
